<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@500;700&family=Tajawal:wght@500;700&display=swap"
    rel="stylesheet">
  <title>Swatly page</title>
  <link rel="stylesheet" href="/static/css/swatly.css" />

</head>

<body>

  <!-- زر فتح السايدبار -->
  <button class="sidebar-toggle" id="openSidebarBtn" title="القائمة">
    <div class="hamburger-menu" id="hamburger-menu">
      <span class="hamburger-menu-item-first"></span>
      <span class="hamburger-menu-item-second"></span>
      <span class="hamburger-menu-item-third"></span>
    </div>
  </button>
  <!-- خلفية شفافة -->
  <div class="sidebar-overlay" id="sidebarOverlay"></div>
  <!-- السايدبار -->
  <aside class="user-sidebar" id="userSidebar">
    <div class="dark-mode">
      <input type="checkbox" id="switch">
      <div class="line"></div>
      <div class="lamp"></div>
    </div>
    <button class="sidebar-close" id="closeSidebarBtn" title="إغلاق">×</button>
    <div class="user-info">
      {% if avatar_url %}
      <img src="{{ avatar_url }}" alt="الصورة الرمزية" width="100" style="border-radius: 50%;">
      {% else %}
      <img src="/static/images/unknonw-user.png" alt="الصورة الرمزية الافتراضية" width="100"
        style="border-radius: 50%;">
      {% endif %}

      <h3>{{ username }}</h3>
      <p>{{ user_email }}</p>
      <p>رقم المتسابق : {{ session_user_id }}</p>
    </div>
    <ul class="sidebar-links">
      <li id="user-profile-li"><a href="{{ url_for('users_profiles') }}" target="_blank" id="user-profile">الملف
          الشخصي</a></li>
      <li style="position: relative;"  id="user-notfications-li">
        <a href="{{ url_for('notifications') }}" style="position: relative;" target="_blank" id="user-notfications">
          الإشعارات
          {% if notifications_count > 0 %}
          <span class="notifications-count">
            {{ notifications_count }}
          </span>
          {% endif %}
        </a>
      </li>
      <li id="user-profile-edit-li"><a href="{{ url_for('profile_edit') }}" target="_blank" id="user-profile-edit">تعديل
          البيانات</a></li>
      <li class="logout-li" id="user-logout-li"><a href="{{ url_for('logout') }}" class="logout-a"
          id="user-logout">تسجيل الخروج</a></li>
    </ul>
  </aside>


  <div class="container" id="container">
    <div class="add-project" id="add-project">
      <button class="close-button" id="close-button">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
          stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="h-4 w-4">
          <path d="M18 6 6 18"></path>
          <path d="m6 6 12 12"></path>
        </svg>
      </button>
      <div class="project-headers" style="margin-top: 10px;">
        <h3 id="add_project_h3">إضافة موقع جديد</h3>
        <p id="add_project_p">شاركنا أفضل مشاريعك وادعم مجتمع المبدعين! يرجى تعبئة المعلومات المطلوبة</p>
      </div>

      <form id="addProjectForm" action="/add_project" method="POST" enctype="multipart/form-data">
        <label for="project_name">اسم الموقع *</label>
        <input type="text" id="project_name" name="project_name" placeholder="مثال: مستكشف التصاميم الابداعية" required
          autocomplete="off">

        <label for="project_img">صورة الموقع *</label>
        <input type="file" id="project_img" name="project_img" autocomplete="off">

        <label for="project_desc">الوصف *</label>
        <textarea id="project_desc" name="project_desc" placeholder="وصف مختصر و جذاب عن الموقع و مميزاته الرئيسية"
          maxlength="80" required autocomplete="off"></textarea>

        <label for="project_url">رابط الموقع *</label>
        <span style="font-size: 12px ; color: #5f5f5f; margin-right: 5px;">*يجب أن يكون الموقع مرفوع علي الانترنت حتي
          يمكن تشغيل رابط الموقع*</span>
        <input type="link" id="project_url" name="project_url" placeholder="https://example.com" required
          autocomplete="on">

        <label for="project_category">الفئة</label>
        <span style="font-size: 12px ; color: #5f5f5f; margin-right: 5px;">*ضع مسافة بين كل كلمة و أخري *</span> <input
          type="text" id="project_category" name="project_category" placeholder="تقنية,تصميم,تعليم..." required
          autocomplete="off">

        <label for="project_make_name">اسم المؤلف</label>
        <input type="text" id="project_make_name" name="project_make_name" placeholder="اسمك أو اسم الفريق الناشئ"
          required autocomplete="off">

        <label for="project_email">أدخل بريدك الالكتروني</label>
        <input type="email" id="project_email" name="project_email" placeholder="name@example.com" required
          autocomplete="on">

        <button class="btn-6" id="btn-6" type="submit">
          <div class="svg-wrapper-1">
            <div class="svg-wrapper">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24">
                <path fill="none" d="M0 0h24v24H0z"></path>
                <path fill="currentColor"
                  d="M1.946 9.315c-.522-.174-.527-.455.01-.634l19.087-6.362c.529-.176.832.12.684.638l-5.454 19.086c-.15.529-.455.547-.679.045L12 14l6-8-8 6-8.054-2.685z">
                </path>
              </svg>
            </div>
          </div>
          <span>إضافة موقع</span>
        </button>
      </form>
    </div>
  </div>



  {% if warning_message %}
  <div id="toast" class="show warning">
    <div id="img"><svg width="256px" height="256px" viewBox="0 0 14.00 14.00" xmlns="http://www.w3.org/2000/svg"
        fill="#fffafa" stroke="#fffafa" stroke-width="0.00014">
        <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
        <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
        <g id="SVGRepo_iconCarrier">
          <g fill-rule="evenodd">
            <path d="M0 7a7 7 0 1 1 14 0A7 7 0 0 1 0 7z"></path>
            <path d="M13 7A6 6 0 1 0 1 7a6 6 0 0 0 12 0z" fill="#ff0000" style="fill: var(--svg-status-bg, #ff0000);">
            </path>
            <path
              d="M7 5.969L5.599 4.568a.29.29 0 0 0-.413.004l-.614.614a.294.294 0 0 0-.004.413L5.968 7l-1.4 1.401a.29.29 0 0 0 .004.413l.614.614c.113.114.3.117.413.004L7 8.032l1.401 1.4a.29.29 0 0 0 .413-.004l.614-.614a.294.294 0 0 0 .004-.413L8.032 7l1.4-1.401a.29.29 0 0 0-.004-.413l-.614-.614a.294.294 0 0 0-.413-.004L7 5.968z">
            </path>
          </g>
        </g>
      </svg></div>
    <div id="desc">{{ warning_message }}</div>
  </div>
  {% endif %}

  {% if message %}
  <div id="toast" class="show success">
    <div id="img"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" fill="#37ff00" stroke="#37ff00"
        stroke-width="0.01024">
        <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
        <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
        <g id="SVGRepo_iconCarrier">
          <path fill="#00ff62"
            d="M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896zm-55.808 536.384-99.52-99.584a38.4 38.4 0 1 0-54.336 54.336l126.72 126.72a38.272 38.272 0 0 0 54.336 0l262.4-262.464a38.4 38.4 0 1 0-54.272-54.336L456.192 600.384z">
          </path>
        </g>
      </svg></div>
    <div id="desc">{{ message }}</div>
  </div>
  {% endif %}




  <header id="header">
    <h1 class="theHead" id="theHead">موقع <span>صوّتلي</span></h1>
    <p class="theSubHead" id="theSubHead">
      موقع صولتي هو منصة لعرض مشاريع الآخرين مع إمكانية التصويت عليها ودعم أفضل الأفكار بسهولة.
      يمكنك استكشاف المشاريع والتصويت للمشاريع التي تعجبك في تجربة تفاعلية مميزة
    </p>
    <div>
      <button class="addProject" id="addProject">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
          stroke-linecap="round" stroke-linejoin="round" class="w-5 h-5 mr-2 rtl:ml-2 rtl:mr-0">
          <path d="M5 12h14"></path>
          <path d="M12 5v14"></path>
        </svg>أضف موقع جديد</button>

      <div class="numProjects">
        <svg xmlns="http://www.w3.org/2000/svg" style="color:rgb(250 204 21);" viewBox="0 0 24 24" fill="none"
          stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
          class="w-7 h-7 text-yellow-400 drop-shadow-lg">
          <path d="M6 9H4.5a2.5 2.5 0 0 1 0-5H6"></path>
          <path d="M18 9h1.5a2.5 2.5 0 0 0 0-5H18"></path>
          <path d="M4 22h16"></path>
          <path d="M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22"></path>
          <path d="M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22"></path>
          <path d="M18 2H6v7a6 6 0 0 0 12 0V2Z"></path>
        </svg><span class="font-semibold text-lg" style="margin-left: 10px;">إجمالي المواقع: {{ cards_count }}</span>
      </div>
    </div>
  </header>

  <navbar class="info_bar" id="info_bar">
    <div class="most_voted">
      <button href="#" id="filter-best" class="nav_link"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
          viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
          stroke-linejoin="round" class="w-5 h-5 mr-2 rtl:ml-2 rtl:mr-0">
          <path d="M6 9H4.5a2.5 2.5 0 0 1 0-5H6"></path>
          <path d="M18 9h1.5a2.5 2.5 0 0 0 0-5H18"></path>
          <path d="M4 22h16"></path>
          <path d="M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22"></path>
          <path d="M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22"></path>
          <path d="M18 2H6v7a6 6 0 0 0 12 0V2Z"></path>
        </svg>الأفضل تقييماً</button>
    </div>
    <div class="new_projects">
      <button href="#" id="filter-new" class="nav_link"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
          viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
          stroke-linejoin="round" class="w-5 h-5 mr-2 rtl:ml-2 rtl:mr-0">
          <path
            d="m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z">
          </path>
          <path d="M5 3v4"></path>
          <path d="M19 17v4"></path>
          <path d="M3 5h4"></path>
          <path d="M17 19h4"></path>
        </svg>المضاف حديثاً</button>
    </div>
    <div class="all_projects">
      <button href="#" id="filter-all" class="nav_link"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
          viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
          stroke-linejoin="round" class="w-5 h-5 mr-2 rtl:ml-2 rtl:mr-0">
          <path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"></path>
          <circle cx="12" cy="12" r="3"></circle>
        </svg>جميع المواقع</button>
    </div>
    </div>
  </navbar>


  <div id="search-sort-bar">
    <input type="text" id="search-input" placeholder="ابحث عن موقع أو مؤلف أو فئة...">
    <select id="sort-select">
      <option value="default">ترتيب افتراضي</option>
      <option value="name-asc">الاسم (أ-ي)</option>
      <option value="name-desc">الاسم (ي-أ)</option>
      <option value="date-newest">الأحدث</option>
      <option value="date-oldest">الأقدم</option>
      <option value="votes-high">الأكثر تصويتاً</option>
      <option value="votes-low">الأقل تصويتاً</option>
    </select>
  </div>

  <section class="projects" id="projects">
    {% if cards %}
    <div class="cards-container" id="cards-container" style="display:flex; flex-wrap:wrap; gap:24px;">
      {% for card in cards %}
      <div class="flip-container" data-rank="{{ card.rank }}" data-card-id="{{ card.id }}"
        data-created="{{ card.created_at.strftime('%Y-%m-%dT%H:%M:%S') if card.created_at else '' }}">
        <div class="flipper" id="flipper">
          <!-- وجه الكارت -->
          <div class="project-card">
            <img src="{{ url_for('static', filename='uploads/' ~ card.card_img) }}" alt="{{ card.project_name }}"
              loading="lazy" width="400" height="250"
              onerror="this.onerror=null;this.src='https://placehold.co/400x250';">
            <div class="middle">
              <div class="text">{{ card.project_make_name }}</div>
            </div>
            {% if card.votes_count > 0 %}
            {% if card.rank == 1 %}
            <svg viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg" fill="#000000">
              <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
              <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
              <g id="SVGRepo_iconCarrier">
                <g id="Flat">
                  <g id="Color">
                    <polygon fill="#212529" points="8.26 3 25.94 33.62 38.06 26.62 24.42 3 8.26 3"></polygon>
                    <path d="M38.06,26.62l-7.21-12.5-3.72,6.44a21.53,21.53,0,0,0-7,3l5.8,10Z" fill="#111315">
                    </path>
                    <polygon fill="#dd051d" points="34.6 28.62 29.4 31.62 12.87 3 19.8 3 34.6 28.62"></polygon>
                    <polygon fill="#212529" points="39.58 3 25.94 26.62 38.06 33.62 55.74 3 39.58 3"></polygon>
                    <path d="M34.6,28.62l-6.06-10.5-1.42,2.46a21.44,21.44,0,0,0-3.46,1.1l5.74,9.94Z" fill="#a60416">
                    </path>
                    <path d="M43.86,23.58a21.46,21.46,0,0,0-14.17-3.45l-3.75,6.49,12.12,7Z" fill="#111315"></path>
                    <polygon fill="#dd051d" points="51.13 3 34.6 31.62 29.4 28.62 44.2 3 51.13 3"></polygon>
                    <path d="M34.6,31.62l5.74-9.94a21.41,21.41,0,0,0-6-1.55L29.4,28.62Z" fill="#a60416"></path>
                    <circle cx="32" cy="41.5" fill="#fccd1d" r="19.5"></circle>
                    <circle cx="32" cy="41.5" fill="#f9a215" r="14.5"></circle>
                    <path
                      d="M34.13,43.63V33H29.88a3.19,3.19,0,0,1-3.19,3.19H25.63v4.25h4.25v3.19a2.13,2.13,0,0,1-2.13,2.12H25.63V50H38.38V45.75H36.25A2.12,2.12,0,0,1,34.13,43.63Z"
                      fill="#fccd1d"></path>
                  </g>
                </g>
              </g>
            </svg>
            {% elif card.rank == 2 %}
            <svg viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg" fill="#000000">
              <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
              <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
              <g id="SVGRepo_iconCarrier">
                <g id="Flat">
                  <g id="Color">
                    <polygon fill="#1c63ab" points="8.26 3 25.94 33.62 38.06 26.62 24.42 3 8.26 3"></polygon>
                    <path d="M38.06,26.62l-7.21-12.5-3.72,6.44a21.53,21.53,0,0,0-7,3l5.8,10Z" fill="#1c63ab">
                    </path>
                    <polygon fill="#dd051d" points="34.6 28.62 29.4 31.62 12.87 3 19.8 3 34.6 28.62"></polygon>
                    <polygon fill="#1c63ab" points="39.58 3 25.94 26.62 38.06 33.62 55.74 3 39.58 3"></polygon>
                    <path d="M34.6,28.62l-6.06-10.5-1.42,2.46a21.44,21.44,0,0,0-3.46,1.1l5.74,9.94Z" fill="#a60416">
                    </path>
                    <path d="M43.86,23.58a21.46,21.46,0,0,0-14.17-3.45l-3.75,6.49,12.12,7Z" fill="#1c63ab"></path>
                    <polygon fill="#dd051d" points="51.13 3 34.6 31.62 29.4 28.62 44.2 3 51.13 3"></polygon>
                    <path d="M34.6,31.62l5.74-9.94a21.41,21.41,0,0,0-6-1.55L29.4,28.62Z" fill="#a60416"></path>
                    <circle cx="32" cy="41.5" fill="#b5b0b0" r="19.5"></circle>
                    <circle cx="32" cy="41.5" fill="#d4d3d3" r="14.5"></circle>
                    <path
                      d="M33.88,33.57a6.49,6.49,0,0,0-5.81,1.23,6.41,6.41,0,0,0-2.21,4.89H30c0-2.24,3.37-2.38,4-1,1,2.1-8,7-8,7v4H38v-4H34a7.07,7.07,0,0,0,4-7.54A6.16,6.16,0,0,0,33.88,33.57Z"
                      fill="#b5b0b0"></path>
                  </g>
                </g>
              </g>
            </svg>
            {% elif card.rank == 3 %}
            <svg viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg" fill="#000000">
              <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
              <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
              <g id="SVGRepo_iconCarrier">
                <g id="Flat">
                  <g id="Color">
                    <polygon fill="#212529" points="45 17 32 25 19 17 19 3 45 3 45 17"></polygon>
                    <polygon fill="#dd051d" points="40 3 40 20.08 32 25 24 20.08 24 3 40 3"></polygon>
                    <path d="M32,25l6.49-4a21.36,21.36,0,0,0-13,0Z" fill="#a60416"></path>
                    <circle cx="32" cy="41.5" fill="#CD7F32" r="19.5"></circle>
                    <circle cx="32" cy="41.5" fill="#fc9d03" r="14.5"></circle>
                    <path
                      d="M36.54,41.5A4.52,4.52,0,0,0,38.38,38c0-2.76-2.86-5-6.38-5s-6.37,2.24-6.37,5h3.92a2,2,0,0,1,3.9-.29c.17,1.23-.77,2.73-2,2.73v2.12c2.22,0,2.84,3.5.72,4.32A2,2,0,0,1,29.55,45H25.63c0,2.76,2.85,5,6.37,5s6.38-2.24,6.38-5A4.52,4.52,0,0,0,36.54,41.5Z"
                      fill="#CD7F32"></path>
                  </g>
                </g>
              </g>
            </svg>
            {% endif %}
            {% endif %}
            <div class="project-content">
              <span style="color:#888; font-size:14px;">رقم المتسابق: <b name="card_id" value="{{ card.id }}">{{ card.id
                  }}</b></span>

              <div style="display:flex; align-items:center; justify-content:space-between; gap:10px;">
                <div class="project-title" style="display: flex; align-items: center; gap: 3px;">
                  {{ card.project_name }}
                </div>

                {% if card.user_id == session_user_id %}
                <button class="edit-btn" id="edit-btn">
                  <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                    stroke="currentColor" class="size-6">
                    <path stroke-linecap="round" stroke-linejoin="round"
                      d="m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10" />
                  </svg>
                  تعديل البيانات
                </button>
                {% else %}


                {% endif %}


              </div>
              <div class="project-desc">{{ card.project_desc }}</div>
              <div class="project-info">
                <span class="project-maker"><svg class="project-maker-svg" width="18" height="18" viewBox="0 0 24 24"
                    fill="none" stroke="#2d6a4f" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                    style="vertical-align:middle;">
                    <circle cx="12" cy="8" r="4"></circle>
                    <path d="M4 20v-1a4 4 0 014-4h8a4 4 0 014 4v1"></path>
                  </svg>{{ card.project_make_name }}</span>
                <span class="project-email"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#1976d2"
                    stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="vertical-align:middle;">
                    <rect x="3" y="5" width="18" height="14" rx="2"></rect>
                    <polyline points="3 7 12 13 21 7"></polyline>
                  </svg>
                  {{ card.project_email }}</span>
              </div>
              <div class="category-div">
                {% for word in (card.project_category or '').split() %}
                <span class="project-category">{{ word }}</span>
                {% endfor %}
              </div>
              <a class="explore-btn" href="{{ card.project_url }}" target="_blank">استكشاف الموقع وتجربته</a>

              <form class="edit-fields" id="edit-fields" style="display:none;" action="save_edits" method="post"
                enctype="multipart/form-data">

                <label for="card_id">رقم المتسابق *</label>
                <input type="text" name="card_id" value="{{ card.id }}" readonly>

                <label for="project_name">اسم الموقع *</label>
                <input type="text" id="new_project_name" name="new_project_name" required
                  value="{{ card.project_name }}" autocomplete="off">

                <label for="project_img">رابط صورة الموقع *</label>
                <input type="file" id="new_project_img" name="new_project_img" accept="image/*" autocomplete="off">
                <label>اسم الملف الحالي: <b style="color:#7693fc;">{{ card.card_img }}</b></label><br>

                <label for="project_desc">الوصف *</label>
                <textarea id="new_project_desc" name="new_project_desc" required
                  autocomplete="off">{{ card.project_desc }}</textarea>

                <label for="project_url">رابط الموقع *</label>
                <input type="link" id="new_project_url" name="new_project_url" required value="{{ card.project_url }}"
                  autocomplete="off">

                <label for="project_category">الفئة</label>
                <span style="font-size: 12px ; color: #5f5f5f; margin-right: 5px;">*ضع مسافة بين كل كلمة و أخري *</span>
                <input type="text" id="new_project_category" name="new_project_category" required
                  value="{{ card.project_category }}" autocomplete="off">

                <label for="project_make_name">اسم المؤلف</label>
                <input type="text" id="new_project_make_name" name="new_project_make_name" required
                  value="{{ card.project_make_name }}" autocomplete="off">

                <label for="project_email">أدخل بريدك الالكتروني</label>
                <input type="email" id="new_project_email" name="new_project_email" required
                  value="{{ card.project_email }}" autocomplete="off">

                <div style="display:flex;gap:7px;justify-content:flex-end;">
                  <button type="submit" class="save-btn">حفظ البيانات</button>
                  <button type="button" class="cancel-btn">إلغاء</button>
                </div>
              </form>

              <hr class="divider" />

              <form action="add_comment" method="post">
            </div>
            <div class="comment-section">
              <div class="comment-header">أضف تعليقك</div>
              <div class="comment-controls">
                <input type="hidden" name="card_id" value="{{ card.id }}"> <!-- the flask take the user_id from this -->
                <input type="text" placeholder="اكتب تعليقك هنا..." class="comment-input" name="comment-input" />
                <button class="add-comment">إرسال</button>
              </div>
            </div>
            </form>

            <button onclick="flipCard({{ card.id }})" class="show-comments">
              عرض التعليقات (<span class="commentsCount">{{ card.comments|length }}</span>)
            </button>

            <div class="stars-container" data-card-id="{{ card.id }}"
              data-already-voted="{{ 'true' if card.already_voted else 'false' }}"
              data-user-vote="{{ card.user_vote or 0 }}">
              <span class="star" data-value="1">&#9733;</span>
              <span class="star" data-value="2">&#9733;</span>
              <span class="star" data-value="3">&#9733;</span>
              <span class="star" data-value="4">&#9733;</span>
              <span class="star" data-value="5">&#9733;</span>
              <span class="vote-message"
                style="display:block;margin-top:6px;color:#1a9c62;font-size:14px;min-height:18px;"></span>
            </div>

            <div class="votes-info"
              style="margin-bottom: 15px;color:#555;font-size:14px;text-align: center;padding: 5px;">
              <!-- نجمة ذهبية SVG -->
              <svg width="16" height="16" style="position:relative; top:2px;" viewBox="0 0 24 24">
                <path fill="#FFD700" d="M12 2l3.09 6.26L22 9.27l-5 4.87L18.18 22 12 18.56 5.82 22 
                  7 14.14l-5-4.87 6.91-1.01z" />
              </svg>
              المتوسط : {{ card.avg_vote }} |
              <!-- أيقونة شخصين SVG -->
              <svg width="16" height="16" style="position:relative; top:2px; margin-left: 2px;" viewBox="0 0 24 24">
                <path fill="#555" d="M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5s-3 1.34-3 
                  3 1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5 5 6.34 5 8s1.34 3 3 
                  3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5C15 14.17 10.33 13 8 13zm8 0c-.29 
                  0-.62.02-.97.05C17.16 13.66 20 14.84 20 16.5V19h4v-2.5c0-2.33-4.67-3.5-8-3.5z" />
              </svg>
              عدد التصويتات: {{ card.votes_count }}
            </div>
          </div>

          <!-- ظهر الكارت -->
          <div class="card-back">
            <div class="comments-title">التعليقات (<span class="commentsCount">{{ card.comments|length }}</span>)</div>
            <div class="comments-list-container">
              {% if card.comments %}
              {% for comment in card.comments %}
              <div class="comment-item">
                <div class="comment-user">{{ comment.user_name }} :</div>
                <div class="comment-text">{{ comment.comment_text }}</div>
                <div class="comment-date">{{ comment.created_at }}</div>
              </div>
              {% endfor %}
              {% else %}
              <div class="no-comments">لا يوجد تعليقات بعد.</div>
              {% endif %}
            </div>
            <button onclick="flipCardBack({{ card.id }})" class="hide-comments"
              style="float:left; cursor: pointer;"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                fill="none" stroke="#222" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <line x1="18" y1="6" x2="6" y2="18" />
                <line x1="6" y1="6" x2="18" y2="18" />
              </svg></button>
          </div>
        </div>
      </div>
      {% endfor %}
    </div>
    {% else %}
    <div style="text-align: center; width: 100%; margin-top: 40px; font-size: 20px; color: #92a4ec;" id="no-projects">
      لا توجد مشاريع حالياً للعرض.
    </div>
    {% endif %}

  </section>

  <div class="button-wrapper" id="button-wrapper">
    <a href="#" class="btn-3" id="btn-3">
      <svg class="svgIcon" viewBox="0 0 384 512">
        <path
          d="M214.6 41.4c-12.5-12.5-32.8-12.5-45.3 0l-160 160c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L160 141.2V448c0 17.7 14.3 32 32 32s32-14.3 32-32V141.2L329.4 246.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3l-160-160z">
        </path>
      </svg>
    </a>
  </div>

  <footer id="footer">
    <div class="footer-content">
      <p>مهرجان الكرازة المرقسية 2025</p>
      <p>تم تطوير الموقع بواسطة <a href="add_project.html">بيشوي هاني فايز</a></p>
  </footer>

  <script src="/static/js/swatly.js"></script>

</body>

</html>